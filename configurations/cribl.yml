{
  "id": "sample",
  "conf": {
    "asyncFuncTimeout": 1000,
    "streamtags": [
      "sampling"
    ],
    "functions": [
      {
        "filter": "pii[\"color\"] == 'Green'",
        "conf": {},
        "id": "drop",
        "disabled": false
      },
      {
        "filter": "true",
        "conf": {
          "rules": [
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/((25[0-5]|(2[0-4]|1\\d|[1-9]|)\\d)\\.?\\b){4}/"
            },
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/"
            },
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/(5[1-5][0-9]{14}|222[1-9][0-9]{12}|22[3-9][0-9]{13}|2[3-6][0-9]{14}|27[01][0-9]{13}|2720[0-9]{12})/"
            },
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/3[47][0-9]{13}/"
            },
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/4[0-9]{12}(?:[0-9]{3})?/"
            },
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/6(?:011|4[4-9][0-9]|5[0-9][0-9])[0-9]{12}/"
            },
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/[A-Z]{2}[0-9]{2}[A-Z0-9]{4}[0-9]{7}([A-Z0-9]?){0,16}/"
            },
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/"
            },
            {
              "replaceExpr": "'REDACTED'",
              "disabled": false,
              "matchRegex": "/([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})/"
            }
          ],
          "fields": [
            "_raw"
          ],
          "depth": 5
        },
        "id": "mask",
        "disabled": false,
        "description": "mask"
      },
      {
        "id": "eval",
        "filter": "true",
        "conf": {
          "add": [
            {
              "disabled": false,
              "name": "ip_address",
              "value": "pii.ipv4"
            }
          ],
          "keep": [
            "*"
          ]
        }
      },
      {
        "id": "lookup",
        "filter": "true",
        "conf": {
          "dbLookup": false,
          "matchMode": "exact",
          "reloadPeriodSec": -1,
          "inFields": [
            {
              "eventField": "ip_address",
              "lookupField": "ip_address"
            }
          ],
          "addToEvent": false,
          "ignoreCase": false,
          "file": "lookup.csv",
          "outFields": [
            {
              "lookupField": "region",
              "eventField": "region",
              "defaultValue": "unknown"
            },
            {
              "lookupField": "env",
              "eventField": "env",
              "defaultValue": "unknown"
            }
          ]
        }
      },
      {
        "id": "sampling",
        "filter": "true",
        "conf": {
          "rules": [
            {
              "filter": "true",
              "rate": 20
            }
          ]
        },
        "final": true
      }
    ],
    "groups": {}
  }
}